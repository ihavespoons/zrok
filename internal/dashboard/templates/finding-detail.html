{{define "finding-detail"}}
<div class="space-y-4">
    <!-- Header -->
    <div class="flex justify-between items-start">
        <div class="flex items-center gap-2">
            <span class="severity-{{.Severity}} text-xs px-2 py-1 rounded uppercase font-bold">
                {{.Severity}}
            </span>
            <span class="text-gray-500 text-sm font-mono">{{.ID}}</span>
        </div>
        <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600 text-2xl">&times;</button>
    </div>

    <h2 class="text-xl font-bold text-gray-800">{{.Title}}</h2>

    <!-- Metadata Grid -->
    <div class="grid grid-cols-2 gap-4 text-sm">
        <div>
            <span class="text-gray-500">Status</span>
            <div class="status-{{.Status}} inline-block px-2 py-1 rounded mt-1">{{.Status}}</div>
        </div>
        <div>
            <span class="text-gray-500">Confidence</span>
            <div class="font-medium mt-1 capitalize">{{.Confidence}}</div>
        </div>
        {{if .CWE}}
        <div>
            <span class="text-gray-500">CWE</span>
            <div class="font-medium mt-1">{{.CWE}}</div>
        </div>
        {{end}}
        {{if .CVSS}}
        <div>
            <span class="text-gray-500">CVSS Score</span>
            <div class="font-medium mt-1">{{.CVSS.Score}}</div>
        </div>
        {{end}}
    </div>

    <!-- Location -->
    <div class="bg-gray-50 rounded-lg p-4">
        <h3 class="text-sm font-medium text-gray-500 mb-2">Location</h3>
        <code class="text-sm bg-gray-100 px-2 py-1 rounded">
            {{.Location.File}}:{{.Location.LineStart}}{{if .Location.LineEnd}}-{{.Location.LineEnd}}{{end}}
        </code>
        {{if .Location.Function}}
        <div class="text-sm text-gray-600 mt-1">Function: <code>{{.Location.Function}}</code></div>
        {{end}}
    </div>

    <!-- Code Snippet -->
    {{if .Location.Snippet}}
    <div>
        <h3 class="text-sm font-medium text-gray-500 mb-2">Code</h3>
        <pre class="code-snippet">{{.Location.Snippet}}</pre>
    </div>
    {{end}}

    <!-- Description -->
    {{if .Description}}
    <div>
        <h3 class="text-sm font-medium text-gray-500 mb-2">Description</h3>
        <p class="text-gray-700">{{.Description}}</p>
    </div>
    {{end}}

    <!-- Impact -->
    {{if .Impact}}
    <div>
        <h3 class="text-sm font-medium text-gray-500 mb-2">Impact</h3>
        <p class="text-gray-700">{{.Impact}}</p>
    </div>
    {{end}}

    <!-- Evidence -->
    {{if .Evidence}}
    <div>
        <h3 class="text-sm font-medium text-gray-500 mb-2">Evidence</h3>
        <ul class="list-disc list-inside text-gray-700 text-sm space-y-1">
            {{range .Evidence}}
            <li><strong>{{.Type}}:</strong> {{.Description}}</li>
            {{end}}
        </ul>
    </div>
    {{end}}

    <!-- Remediation -->
    {{if .Remediation}}
    <div class="bg-green-50 rounded-lg p-4">
        <h3 class="text-sm font-medium text-green-700 mb-2">Remediation</h3>
        <p class="text-green-800 text-sm">{{.Remediation}}</p>
    </div>
    {{end}}

    <!-- Tags -->
    {{if .Tags}}
    <div class="flex flex-wrap gap-2">
        {{range .Tags}}
        <span class="bg-gray-100 text-gray-600 px-2 py-1 rounded text-xs">{{.}}</span>
        {{end}}
    </div>
    {{end}}

    <!-- Actions -->
    <div class="flex gap-2 pt-4 border-t">
        <button onclick="updateFindingStatus('{{.ID}}', 'confirmed')"
                class="bg-red-600 text-white px-4 py-2 rounded text-sm hover:bg-red-700">
            Confirm
        </button>
        <button onclick="updateFindingStatus('{{.ID}}', 'false_positive')"
                class="bg-gray-500 text-white px-4 py-2 rounded text-sm hover:bg-gray-600">
            False Positive
        </button>
        <button onclick="updateFindingStatus('{{.ID}}', 'fixed')"
                class="bg-green-600 text-white px-4 py-2 rounded text-sm hover:bg-green-700">
            Mark Fixed
        </button>
    </div>
</div>
{{end}}
